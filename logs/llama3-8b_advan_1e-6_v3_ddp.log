nohup: ignoring input
[W1001 14:03:09.057674592 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [::ffff:127.0.0.1]:29500 (errno: 97 - Address family not supported by protocol).
⚙️  Running in WANDB offline mode
⚙️  Running in WANDB offline mode
⚙️  Running in WANDB offline mode
⚙️  Running in WANDB offline mode
从磁盘加载预处理好的数据集...
加载用于训练的策略模型...
从磁盘加载预处理好的数据集...
`torch_dtype` is deprecated! Use `dtype` instead!
加载用于训练的策略模型...
`torch_dtype` is deprecated! Use `dtype` instead!
从磁盘加载预处理好的数据集...
加载用于训练的策略模型...
`torch_dtype` is deprecated! Use `dtype` instead!
从磁盘加载预处理好的数据集...
加载用于训练的策略模型...
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 90.97it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 90.16it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 89.56it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 94.24it/s]
[W1001 14:03:14.356443597 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [::ffff:127.0.0.1]:29500 (errno: 97 - Address family not supported by protocol).
[W1001 14:03:14.371536283 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [::ffff:127.0.0.1]:29500 (errno: 97 - Address family not supported by protocol).
[W1001 14:03:14.387066901 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [::ffff:127.0.0.1]:29500 (errno: 97 - Address family not supported by protocol).
[W1001 14:03:14.400687169 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [::ffff:127.0.0.1]:29500 (errno: 97 - Address family not supported by protocol).
初始化 CustomSymPOTrainer...
/rlhf_code/code/implement_final_v3.py:36: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSymPOTrainer.__init__`. Use `processing_class` instead.
  super().__init__(model=model, args=args, **kwargs)
初始化 CustomSymPOTrainer...
/rlhf_code/code/implement_final_v3.py:36: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSymPOTrainer.__init__`. Use `processing_class` instead.
  super().__init__(model=model, args=args, **kwargs)
初始化 CustomSymPOTrainer...
/rlhf_code/code/implement_final_v3.py:36: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSymPOTrainer.__init__`. Use `processing_class` instead.
  super().__init__(model=model, args=args, **kwargs)
初始化 CustomSymPOTrainer...
/rlhf_code/code/implement_final_v3.py:36: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSymPOTrainer.__init__`. Use `processing_class` instead.
  super().__init__(model=model, args=args, **kwargs)
Detected kernel version 5.4.119, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
开始分布式训练...
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'pad_token_id': 128009}.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
开始分布式训练...
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'pad_token_id': 128009}.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
开始分布式训练...
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'pad_token_id': 128009}.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
开始分布式训练...
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'pad_token_id': 128009}.
/root/miniconda3/envs/advan/lib/python3.12/site-packages/accelerate/accelerator.py:1962: UserWarning: Upcasted low precision parameters in LlamaForCausalLM because mixed precision turned on in FSDP. Affects: model.embed_tokens.weight, model.norm.weight, lm_head.weight.
  warnings.warn(
/root/miniconda3/envs/advan/lib/python3.12/site-packages/accelerate/accelerator.py:1962: UserWarning: Upcasted low precision parameters in LlamaDecoderLayer because mixed precision turned on in FSDP. Affects: self_attn.q_proj.weight, self_attn.k_proj.weight, self_attn.v_proj.weight, self_attn.o_proj.weight, mlp.gate_proj.weight, mlp.up_proj.weight, mlp.down_proj.weight, input_layernorm.weight, post_attention_layernorm.weight.
  warnings.warn(
/root/miniconda3/envs/advan/lib/python3.12/site-packages/accelerate/accelerator.py:1968: UserWarning: FSDP upcast of low precision parameters may affect the precision of model checkpoints.
  warnings.warn(
wandb: Tracking run with wandb version 0.21.3
wandb: W&B syncing is set to `offline` in this directory. Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: Run data is saved locally in /root/wandb/offline-run-20251001_140321-1jp87ais
  0%|          | 0/11259 [00:00<?, ?it/s]Could not estimate the number of tokens of the input, floating-point operations will not be computed
Could not estimate the number of tokens of the input, floating-point operations will not be computed
Could not estimate the number of tokens of the input, floating-point operations will not be computed
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/11259 [00:03<11:57:35,  3.82s/it]{'loss': 392.2093, 'grad_norm': 1006.5914306640625, 'learning_rate': 0.0, 'mean_ratio_chosen': 2.2513351440429688, 'mean_ratio_rejected': 1.318693995475769, 'weight_chosen': 0.6932617425918579, 'weight_rejected': 0.3245391845703125, 'epoch': 0.0002664890073284477}
                                                    {'loss': 392.2093, 'grad_norm': 1006.5914306640625, 'learning_rate': 0.0, 'mean_ratio_chosen': 2.2513351440429688, 'mean_ratio_rejected': 1.318693995475769, 'weight_chosen': 0.6932617425918579, 'weight_rejected': 0.3245391845703125, 'epoch': 0.0}
  0%|          | 1/11259 [00:03<11:57:35,  3.82s/it]  0%|          | 2/11259 [00:07<11:41:54,  3.74s/it]  0%|          | 3/11259 [00:11<11:22:10,  3.64s/it]  0%|          | 4/11259 [00:14<10:45:14,  3.44s/it]  0%|          | 5/11259 [00:17<11:08:28,  3.56s/it]  0%|          | 6/11259 [00:21<11:20:04,  3.63s/it]  0%|          | 7/11259 [00:24<10:53:47,  3.49s/it]  0%|          | 8/11259 [00:28<10:52:45,  3.48s/it]  0%|          | 9/11259 [00:31<10:21:39,  3.32s/it]  0%|          | 10/11259 [00:34<10:27:34,  3.35s/it]{'loss': 443.279, 'grad_norm': 3270.33154296875, 'learning_rate': 7.992895204262877e-09, 'mean_ratio_chosen': 1.0084046125411987, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': 0.910295844078064, 'weight_rejected': 10.613250732421875, 'epoch': 0.002664890073284477}
                                                     {'loss': 443.279, 'grad_norm': 3270.33154296875, 'learning_rate': 7.992895204262877e-09, 'mean_ratio_chosen': 1.0084046125411987, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': 0.910295844078064, 'weight_rejected': 10.613250732421875, 'epoch': 0.0}
  0%|          | 10/11259 [00:34<10:27:34,  3.35s/it]  0%|          | 11/11259 [00:38<10:44:35,  3.44s/it]  0%|          | 12/11259 [00:41<10:52:01,  3.48s/it]  0%|          | 13/11259 [00:45<10:42:18,  3.43s/it]  0%|          | 14/11259 [00:48<10:28:57,  3.36s/it]  0%|          | 15/11259 [00:51<10:24:00,  3.33s/it]  0%|          | 16/11259 [00:55<10:32:01,  3.37s/it]  0%|          | 17/11259 [00:58<10:07:26,  3.24s/it]  0%|          | 18/11259 [01:01<10:28:29,  3.35s/it]  0%|          | 19/11259 [01:04<9:57:12,  3.19s/it]   0%|          | 20/11259 [01:07<9:51:34,  3.16s/it]{'loss': 553.3742, 'grad_norm': 2014.4228515625, 'learning_rate': 1.6873889875666073e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -52.07514572143555, 'weight_rejected': 52.881141662597656, 'epoch': 0.005329780146568954}
                                                    {'loss': 553.3742, 'grad_norm': 2014.4228515625, 'learning_rate': 1.6873889875666073e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -52.07514572143555, 'weight_rejected': 52.881141662597656, 'epoch': 0.01}
  0%|          | 20/11259 [01:07<9:51:34,  3.16s/it]  0%|          | 21/11259 [01:11<10:29:59,  3.36s/it]  0%|          | 22/11259 [01:16<12:25:07,  3.98s/it]  0%|          | 23/11259 [01:20<12:02:04,  3.86s/it]  0%|          | 24/11259 [01:23<11:01:15,  3.53s/it]  0%|          | 25/11259 [01:26<10:46:22,  3.45s/it]  0%|          | 26/11259 [01:29<10:37:32,  3.41s/it]  0%|          | 27/11259 [01:33<10:50:09,  3.47s/it]  0%|          | 28/11259 [01:36<10:18:55,  3.31s/it]  0%|          | 29/11259 [01:39<10:06:30,  3.24s/it]  0%|          | 30/11259 [01:42<10:09:28,  3.26s/it]{'loss': 411.6073, 'grad_norm': 5370.04638671875, 'learning_rate': 2.575488454706927e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -113.82574462890625, 'weight_rejected': 114.23138427734375, 'epoch': 0.007994670219853431}
                                                     {'loss': 411.6073, 'grad_norm': 5370.04638671875, 'learning_rate': 2.575488454706927e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -113.82574462890625, 'weight_rejected': 114.23138427734375, 'epoch': 0.01}
  0%|          | 30/11259 [01:42<10:09:28,  3.26s/it]  0%|          | 31/11259 [01:46<10:46:20,  3.45s/it]  0%|          | 32/11259 [01:50<11:08:04,  3.57s/it]  0%|          | 33/11259 [01:53<10:45:01,  3.45s/it]  0%|          | 34/11259 [01:57<11:21:43,  3.64s/it]  0%|          | 35/11259 [02:01<11:36:44,  3.72s/it]  0%|          | 36/11259 [02:05<12:08:30,  3.89s/it]  0%|          | 37/11259 [02:10<12:44:25,  4.09s/it]  0%|          | 38/11259 [02:14<12:29:23,  4.01s/it]  0%|          | 39/11259 [02:19<13:34:12,  4.35s/it]  0%|          | 40/11259 [02:22<12:25:01,  3.98s/it]{'loss': 491.207, 'grad_norm': 3203.327392578125, 'learning_rate': 3.4635879218472466e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -69.47554016113281, 'weight_rejected': 72.55333709716797, 'epoch': 0.010659560293137908}
                                                     {'loss': 491.207, 'grad_norm': 3203.327392578125, 'learning_rate': 3.4635879218472466e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -69.47554016113281, 'weight_rejected': 72.55333709716797, 'epoch': 0.01}
  0%|          | 40/11259 [02:22<12:25:01,  3.98s/it]  0%|          | 41/11259 [02:26<12:38:16,  4.06s/it]  0%|          | 42/11259 [02:29<11:33:43,  3.71s/it]  0%|          | 43/11259 [02:34<12:10:09,  3.91s/it]  0%|          | 44/11259 [02:37<11:21:43,  3.65s/it]  0%|          | 45/11259 [02:40<11:20:16,  3.64s/it]  0%|          | 46/11259 [02:44<11:24:56,  3.67s/it]  0%|          | 47/11259 [02:47<10:40:53,  3.43s/it]  0%|          | 48/11259 [02:51<10:55:31,  3.51s/it]  0%|          | 49/11259 [02:54<10:55:12,  3.51s/it]  0%|          | 50/11259 [02:57<10:23:44,  3.34s/it]{'loss': 504.159, 'grad_norm': 1158.273193359375, 'learning_rate': 4.351687388987566e-08, 'mean_ratio_chosen': 0.10025884956121445, 'mean_ratio_rejected': 2.198729991912842, 'weight_chosen': 17.279022216796875, 'weight_rejected': 0.19304580986499786, 'epoch': 0.013324450366422385}
                                                     {'loss': 504.159, 'grad_norm': 1158.273193359375, 'learning_rate': 4.351687388987566e-08, 'mean_ratio_chosen': 0.10025884956121445, 'mean_ratio_rejected': 2.198729991912842, 'weight_chosen': 17.279022216796875, 'weight_rejected': 0.19304580986499786, 'epoch': 0.01}
  0%|          | 50/11259 [02:57<10:23:44,  3.34s/it]  0%|          | 51/11259 [03:00<10:18:42,  3.31s/it]  0%|          | 52/11259 [03:04<10:46:45,  3.46s/it]  0%|          | 53/11259 [03:08<11:33:03,  3.71s/it]  0%|          | 54/11259 [03:12<11:28:52,  3.69s/it]  0%|          | 55/11259 [03:17<12:41:59,  4.08s/it]  0%|          | 56/11259 [03:22<13:47:10,  4.43s/it]  1%|          | 57/11259 [03:26<13:00:21,  4.18s/it]  1%|          | 58/11259 [03:29<12:02:56,  3.87s/it]  1%|          | 59/11259 [03:34<13:35:17,  4.37s/it]  1%|          | 60/11259 [03:37<12:18:09,  3.95s/it]{'loss': 476.2313, 'grad_norm': 7803.80908203125, 'learning_rate': 5.239786856127886e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -99.80026245117188, 'weight_rejected': 101.37657928466797, 'epoch': 0.015989340439706862}
                                                     {'loss': 476.2313, 'grad_norm': 7803.80908203125, 'learning_rate': 5.239786856127886e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -99.80026245117188, 'weight_rejected': 101.37657928466797, 'epoch': 0.02}
  1%|          | 60/11259 [03:38<12:18:09,  3.95s/it]  1%|          | 61/11259 [03:41<11:57:59,  3.85s/it]  1%|          | 62/11259 [03:44<11:32:30,  3.71s/it]  1%|          | 63/11259 [03:48<11:25:11,  3.67s/it]  1%|          | 64/11259 [03:52<11:30:51,  3.70s/it]  1%|          | 65/11259 [03:56<11:42:46,  3.77s/it]  1%|          | 66/11259 [03:59<11:26:24,  3.68s/it]  1%|          | 67/11259 [04:03<11:09:12,  3.59s/it]  1%|          | 68/11259 [04:06<10:36:21,  3.41s/it]  1%|          | 69/11259 [04:09<10:54:02,  3.51s/it]  1%|          | 70/11259 [04:13<10:57:04,  3.52s/it]{'loss': 456.1916, 'grad_norm': 871.6520385742188, 'learning_rate': 6.127886323268205e-08, 'mean_ratio_chosen': 2.0466134548187256, 'mean_ratio_rejected': 0.10025884956121445, 'weight_chosen': 0.7506469488143921, 'weight_rejected': -8.275787353515625, 'epoch': 0.018654230512991338}
                                                     {'loss': 456.1916, 'grad_norm': 871.6520385742188, 'learning_rate': 6.127886323268205e-08, 'mean_ratio_chosen': 2.0466134548187256, 'mean_ratio_rejected': 0.10025884956121445, 'weight_chosen': 0.7506469488143921, 'weight_rejected': -8.275787353515625, 'epoch': 0.02}
  1%|          | 70/11259 [04:13<10:57:04,  3.52s/it]  1%|          | 71/11259 [04:17<11:10:34,  3.60s/it]  1%|          | 72/11259 [04:20<10:55:01,  3.51s/it]  1%|          | 73/11259 [04:23<10:24:40,  3.35s/it]  1%|          | 74/11259 [04:26<10:18:56,  3.32s/it]  1%|          | 75/11259 [04:29<10:14:20,  3.30s/it]  1%|          | 76/11259 [04:34<11:32:11,  3.71s/it]  1%|          | 77/11259 [04:37<10:33:01,  3.40s/it]  1%|          | 78/11259 [04:40<10:45:58,  3.47s/it]  1%|          | 79/11259 [04:44<10:55:19,  3.52s/it]  1%|          | 80/11259 [04:48<11:16:55,  3.63s/it]{'loss': 506.9597, 'grad_norm': 1478.083251953125, 'learning_rate': 7.015985790408526e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -0.06957095861434937, 'weight_rejected': 35.24384307861328, 'epoch': 0.021319120586275817}
                                                     {'loss': 506.9597, 'grad_norm': 1478.083251953125, 'learning_rate': 7.015985790408526e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -0.06957095861434937, 'weight_rejected': 35.24384307861328, 'epoch': 0.02}
  1%|          | 80/11259 [04:48<11:16:55,  3.63s/it]  1%|          | 81/11259 [04:52<11:40:59,  3.76s/it]  1%|          | 82/11259 [04:55<11:01:26,  3.55s/it]  1%|          | 83/11259 [04:59<11:38:48,  3.75s/it]  1%|          | 84/11259 [05:03<11:41:04,  3.76s/it]  1%|          | 85/11259 [05:06<10:52:53,  3.51s/it]  1%|          | 86/11259 [05:09<10:52:24,  3.50s/it]  1%|          | 87/11259 [05:14<11:49:58,  3.81s/it]  1%|          | 88/11259 [05:17<11:09:45,  3.60s/it]  1%|          | 89/11259 [05:20<10:45:31,  3.47s/it]  1%|          | 90/11259 [05:24<10:41:18,  3.45s/it]{'loss': 456.1915, 'grad_norm': 0.0, 'learning_rate': 7.904085257548846e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 0.10025884956121445, 'weight_chosen': 0.27520751953125, 'weight_rejected': -1.342803955078125, 'epoch': 0.023984010659560292}
                                                     {'loss': 456.1915, 'grad_norm': 0.0, 'learning_rate': 7.904085257548846e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 0.10025884956121445, 'weight_chosen': 0.27520751953125, 'weight_rejected': -1.342803955078125, 'epoch': 0.02}
  1%|          | 90/11259 [05:24<10:41:18,  3.45s/it]  1%|          | 91/11259 [05:27<10:20:15,  3.33s/it]  1%|          | 92/11259 [05:30<10:40:35,  3.44s/it]  1%|          | 93/11259 [05:34<11:01:59,  3.56s/it]  1%|          | 94/11259 [05:37<10:28:34,  3.38s/it]  1%|          | 95/11259 [05:42<11:37:41,  3.75s/it]  1%|          | 96/11259 [05:45<11:22:51,  3.67s/it]  1%|          | 97/11259 [05:49<11:45:48,  3.79s/it]  1%|          | 98/11259 [05:54<12:10:35,  3.93s/it]  1%|          | 99/11259 [05:57<11:11:06,  3.61s/it]  1%|          | 100/11259 [05:59<10:23:22,  3.35s/it]{'loss': 511.0909, 'grad_norm': 0.0, 'learning_rate': 8.792184724689165e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -29.63265037536621, 'weight_rejected': 41.87193298339844, 'epoch': 0.02664890073284477}
                                                      {'loss': 511.0909, 'grad_norm': 0.0, 'learning_rate': 8.792184724689165e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -29.63265037536621, 'weight_rejected': 41.87193298339844, 'epoch': 0.03}
  1%|          | 100/11259 [05:59<10:23:22,  3.35s/it]  1%|          | 101/11259 [06:03<10:40:02,  3.44s/it]  1%|          | 102/11259 [06:07<11:14:23,  3.63s/it]  1%|          | 103/11259 [06:10<10:39:48,  3.44s/it]  1%|          | 104/11259 [06:14<11:20:01,  3.66s/it]  1%|          | 105/11259 [06:17<10:50:29,  3.50s/it]  1%|          | 106/11259 [06:21<11:20:35,  3.66s/it]  1%|          | 107/11259 [06:25<11:12:40,  3.62s/it]  1%|          | 108/11259 [06:29<11:31:35,  3.72s/it]  1%|          | 109/11259 [06:32<11:02:05,  3.56s/it]  1%|          | 110/11259 [06:35<10:40:49,  3.45s/it]{'loss': 461.0032, 'grad_norm': 947.1498413085938, 'learning_rate': 9.680284191829484e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': 0.05379486083984375, 'weight_rejected': 15.095053672790527, 'epoch': 0.029313790806129246}
                                                      {'loss': 461.0032, 'grad_norm': 947.1498413085938, 'learning_rate': 9.680284191829484e-08, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': 0.05379486083984375, 'weight_rejected': 15.095053672790527, 'epoch': 0.03}
  1%|          | 110/11259 [06:35<10:40:49,  3.45s/it]  1%|          | 111/11259 [06:39<11:02:50,  3.57s/it]  1%|          | 112/11259 [06:42<10:40:40,  3.45s/it]  1%|          | 113/11259 [06:45<10:32:44,  3.41s/it]  1%|          | 114/11259 [06:49<10:19:07,  3.33s/it]  1%|          | 115/11259 [06:52<10:04:43,  3.26s/it]  1%|          | 116/11259 [06:55<10:12:11,  3.30s/it]  1%|          | 117/11259 [06:58<10:11:30,  3.29s/it]  1%|          | 118/11259 [07:02<10:29:01,  3.39s/it]  1%|          | 119/11259 [07:08<12:27:56,  4.03s/it]  1%|          | 120/11259 [07:11<11:56:56,  3.86s/it]{'loss': 508.572, 'grad_norm': 0.0, 'learning_rate': 1.0568383658969803e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': 0.1963104009628296, 'weight_rejected': 42.06391525268555, 'epoch': 0.031978680879413725}
                                                      {'loss': 508.572, 'grad_norm': 0.0, 'learning_rate': 1.0568383658969803e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': 0.1963104009628296, 'weight_rejected': 42.06391525268555, 'epoch': 0.03}
  1%|          | 120/11259 [07:11<11:56:56,  3.86s/it]  1%|          | 121/11259 [07:14<11:26:58,  3.70s/it]  1%|          | 122/11259 [07:18<11:23:10,  3.68s/it]  1%|          | 123/11259 [07:22<11:17:45,  3.65s/it]  1%|          | 124/11259 [07:25<11:12:32,  3.62s/it]  1%|          | 125/11259 [07:29<11:04:08,  3.58s/it]  1%|          | 126/11259 [07:32<11:03:03,  3.57s/it]  1%|          | 127/11259 [07:35<10:43:51,  3.47s/it]  1%|          | 128/11259 [07:39<10:30:42,  3.40s/it]  1%|          | 129/11259 [07:43<11:30:46,  3.72s/it]  1%|          | 130/11259 [07:47<11:33:35,  3.74s/it]{'loss': 483.5873, 'grad_norm': 0.0, 'learning_rate': 1.1456483126110124e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -13.763739585876465, 'weight_rejected': 1.224432349205017, 'epoch': 0.034643570952698204}
                                                      {'loss': 483.5873, 'grad_norm': 0.0, 'learning_rate': 1.1456483126110124e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -13.763739585876465, 'weight_rejected': 1.224432349205017, 'epoch': 0.03}
  1%|          | 130/11259 [07:47<11:33:35,  3.74s/it]  1%|          | 131/11259 [07:50<10:59:54,  3.56s/it]  1%|          | 132/11259 [07:53<10:16:56,  3.33s/it]  1%|          | 133/11259 [07:56<10:35:36,  3.43s/it]  1%|          | 134/11259 [08:00<10:29:34,  3.40s/it]  1%|          | 135/11259 [08:04<10:51:20,  3.51s/it]  1%|          | 136/11259 [08:06<10:18:55,  3.34s/it]  1%|          | 137/11259 [08:10<10:00:47,  3.24s/it]  1%|          | 138/11259 [08:13<10:26:27,  3.38s/it]  1%|          | 139/11259 [08:16<10:02:07,  3.25s/it]  1%|          | 140/11259 [08:20<11:00:17,  3.56s/it]{'loss': 548.9892, 'grad_norm': 0.0, 'learning_rate': 1.2344582593250443e-07, 'mean_ratio_chosen': 0.10025884956121445, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': 14.777557373046875, 'weight_rejected': 0.4605651795864105, 'epoch': 0.037308461025982675}
                                                      {'loss': 548.9892, 'grad_norm': 0.0, 'learning_rate': 1.2344582593250443e-07, 'mean_ratio_chosen': 0.10025884956121445, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': 14.777557373046875, 'weight_rejected': 0.4605651795864105, 'epoch': 0.04}
  1%|          | 140/11259 [08:21<11:00:17,  3.56s/it]  1%|▏         | 141/11259 [08:24<10:33:13,  3.42s/it]  1%|▏         | 142/11259 [08:28<11:30:03,  3.72s/it]  1%|▏         | 143/11259 [08:31<11:01:57,  3.57s/it]  1%|▏         | 144/11259 [08:35<11:39:53,  3.78s/it]  1%|▏         | 145/11259 [08:40<12:47:27,  4.14s/it]  1%|▏         | 146/11259 [08:44<12:33:46,  4.07s/it]  1%|▏         | 147/11259 [08:49<12:55:09,  4.19s/it]  1%|▏         | 148/11259 [08:52<12:28:14,  4.04s/it]  1%|▏         | 149/11259 [08:56<11:43:42,  3.80s/it]  1%|▏         | 150/11259 [09:00<12:18:05,  3.99s/it]{'loss': 399.7133, 'grad_norm': 2315.401611328125, 'learning_rate': 1.3232682060390762e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': 0.4652053713798523, 'weight_rejected': 57.13360595703125, 'epoch': 0.039973351099267154}
                                                      {'loss': 399.7133, 'grad_norm': 2315.401611328125, 'learning_rate': 1.3232682060390762e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': 0.4652053713798523, 'weight_rejected': 57.13360595703125, 'epoch': 0.04}
  1%|▏         | 150/11259 [09:00<12:18:05,  3.99s/it]  1%|▏         | 151/11259 [09:05<12:40:34,  4.11s/it]  1%|▏         | 152/11259 [09:08<11:44:57,  3.81s/it]  1%|▏         | 153/11259 [09:11<11:30:37,  3.73s/it]  1%|▏         | 154/11259 [09:15<11:17:56,  3.66s/it]  1%|▏         | 155/11259 [09:18<10:52:41,  3.53s/it]  1%|▏         | 156/11259 [09:22<11:02:09,  3.58s/it]  1%|▏         | 157/11259 [09:25<10:52:02,  3.52s/it]  1%|▏         | 158/11259 [09:29<10:50:28,  3.52s/it]  1%|▏         | 159/11259 [09:32<10:33:28,  3.42s/it]  1%|▏         | 160/11259 [09:35<10:39:45,  3.46s/it]{'loss': 422.8968, 'grad_norm': 0.0, 'learning_rate': 1.4120781527531085e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -0.1314605474472046, 'weight_rejected': 17.795269012451172, 'epoch': 0.04263824117255163}
                                                      {'loss': 422.8968, 'grad_norm': 0.0, 'learning_rate': 1.4120781527531085e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -0.1314605474472046, 'weight_rejected': 17.795269012451172, 'epoch': 0.04}
  1%|▏         | 160/11259 [09:35<10:39:45,  3.46s/it]  1%|▏         | 161/11259 [09:39<10:30:52,  3.41s/it]  1%|▏         | 162/11259 [09:42<10:46:26,  3.50s/it]  1%|▏         | 163/11259 [09:45<10:10:30,  3.30s/it]  1%|▏         | 164/11259 [09:50<11:16:26,  3.66s/it]  1%|▏         | 165/11259 [09:54<12:01:51,  3.90s/it]  1%|▏         | 166/11259 [09:57<11:17:54,  3.67s/it]  1%|▏         | 167/11259 [10:01<11:24:29,  3.70s/it]  1%|▏         | 168/11259 [10:05<11:43:10,  3.80s/it]  2%|▏         | 169/11259 [10:08<10:51:53,  3.53s/it]  2%|▏         | 170/11259 [10:11<10:11:14,  3.31s/it]{'loss': 490.6175, 'grad_norm': 0.0, 'learning_rate': 1.5008880994671402e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -24.066511154174805, 'weight_rejected': 1.3734619617462158, 'epoch': 0.04530313124583611}
                                                      {'loss': 490.6175, 'grad_norm': 0.0, 'learning_rate': 1.5008880994671402e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -24.066511154174805, 'weight_rejected': 1.3734619617462158, 'epoch': 0.05}
  2%|▏         | 170/11259 [10:11<10:11:14,  3.31s/it]  2%|▏         | 171/11259 [10:15<10:46:02,  3.50s/it]  2%|▏         | 172/11259 [10:20<12:21:44,  4.01s/it]  2%|▏         | 173/11259 [10:23<11:56:15,  3.88s/it]  2%|▏         | 174/11259 [10:27<11:26:18,  3.71s/it]  2%|▏         | 175/11259 [10:30<11:11:03,  3.63s/it]  2%|▏         | 176/11259 [10:33<10:38:19,  3.46s/it]  2%|▏         | 177/11259 [10:37<10:50:14,  3.52s/it]  2%|▏         | 178/11259 [10:41<11:04:27,  3.60s/it]  2%|▏         | 179/11259 [10:44<10:36:55,  3.45s/it]  2%|▏         | 180/11259 [10:47<10:25:00,  3.38s/it]{'loss': 471.1481, 'grad_norm': 0.0, 'learning_rate': 1.5896980461811721e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -14.524115562438965, 'weight_rejected': 18.349193572998047, 'epoch': 0.047968021319120584}
                                                      {'loss': 471.1481, 'grad_norm': 0.0, 'learning_rate': 1.5896980461811721e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -14.524115562438965, 'weight_rejected': 18.349193572998047, 'epoch': 0.05}
  2%|▏         | 180/11259 [10:47<10:25:00,  3.38s/it]  2%|▏         | 181/11259 [10:51<10:38:25,  3.46s/it]  2%|▏         | 182/11259 [10:55<11:52:22,  3.86s/it]  2%|▏         | 183/11259 [10:59<11:40:36,  3.80s/it]  2%|▏         | 184/11259 [11:03<11:55:59,  3.88s/it]  2%|▏         | 185/11259 [11:07<11:40:10,  3.79s/it]  2%|▏         | 186/11259 [11:10<11:07:24,  3.62s/it]  2%|▏         | 187/11259 [11:13<11:02:17,  3.59s/it]  2%|▏         | 188/11259 [11:17<10:37:16,  3.45s/it]  2%|▏         | 189/11259 [11:22<11:59:14,  3.90s/it]  2%|▏         | 190/11259 [11:25<11:38:49,  3.79s/it]{'loss': 494.8758, 'grad_norm': 2462.88427734375, 'learning_rate': 1.678507992895204e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 7.947889804840088, 'weight_chosen': -0.08409422636032104, 'weight_rejected': 0.5529937744140625, 'epoch': 0.05063291139240506}
                                                      {'loss': 494.8758, 'grad_norm': 2462.88427734375, 'learning_rate': 1.678507992895204e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 7.947889804840088, 'weight_chosen': -0.08409422636032104, 'weight_rejected': 0.5529937744140625, 'epoch': 0.05}
  2%|▏         | 190/11259 [11:25<11:38:49,  3.79s/it]  2%|▏         | 191/11259 [11:28<10:55:52,  3.56s/it]  2%|▏         | 192/11259 [11:34<12:57:33,  4.22s/it]  2%|▏         | 193/11259 [11:37<12:01:11,  3.91s/it]  2%|▏         | 194/11259 [11:41<11:48:15,  3.84s/it]  2%|▏         | 195/11259 [11:44<11:26:08,  3.72s/it]  2%|▏         | 196/11259 [11:47<10:50:52,  3.53s/it]  2%|▏         | 197/11259 [11:53<12:37:23,  4.11s/it]  2%|▏         | 198/11259 [11:56<11:54:37,  3.88s/it]  2%|▏         | 199/11259 [12:00<11:54:01,  3.87s/it]  2%|▏         | 200/11259 [12:04<11:39:40,  3.80s/it]{'loss': 435.2756, 'grad_norm': 0.0, 'learning_rate': 1.767317939609236e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -0.6154297590255737, 'weight_rejected': 12.774136543273926, 'epoch': 0.05329780146568954}
                                                      {'loss': 435.2756, 'grad_norm': 0.0, 'learning_rate': 1.767317939609236e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -0.6154297590255737, 'weight_rejected': 12.774136543273926, 'epoch': 0.05}
  2%|▏         | 200/11259 [12:04<11:39:40,  3.80s/it]  2%|▏         | 201/11259 [12:08<12:18:38,  4.01s/it]  2%|▏         | 202/11259 [12:11<11:21:49,  3.70s/it]  2%|▏         | 203/11259 [12:15<11:32:26,  3.76s/it]  2%|▏         | 204/11259 [12:18<10:48:26,  3.52s/it]  2%|▏         | 205/11259 [12:21<10:35:14,  3.45s/it][rank1]:[W1001 14:15:46.415167009 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=44, addr=localhost:50470, remote=localhost:29500): Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f24e14d9eb0 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694d1 (0x7f24c55ef4d1 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d6a8cd (0x7f24c55f08cd in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b47a (0x7f24c55f147a in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x7f24c55ec19e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x398 (0x7f2484ad1b18 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7f246845abf4 in /root/miniconda3/envs/advan/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7f24e226cac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: clone + 0x44 (0x7f24e22fda04 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank1]:[W1001 14:15:46.418115642 ProcessGroupNCCL.cpp:1783] [PG ID 0 PG GUID 0(default_pg) Rank 1] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
[rank0]:[W1001 14:15:46.428946118 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=44, addr=localhost:50472, remote=localhost:29500): Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f4af56d9eb0 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694d1 (0x7f4ad97ef4d1 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d6a8cd (0x7f4ad97f08cd in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b47a (0x7f4ad97f147a in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x7f4ad97ec19e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x398 (0x7f4a98cd1b18 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7f4a7c65abf4 in /root/miniconda3/envs/advan/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7f4af6491ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: clone + 0x44 (0x7f4af6522a04 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank0]:[W1001 14:15:46.431716021 ProcessGroupNCCL.cpp:1783] [PG ID 0 PG GUID 0(default_pg) Rank 0] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
[rank3]:[W1001 14:15:46.444234164 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=44, addr=localhost:50474, remote=localhost:29500): Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7fdf9357eeb0 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694d1 (0x7fdf775ef4d1 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d6a8cd (0x7fdf775f08cd in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b47a (0x7fdf775f147a in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x7fdf775ec19e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x398 (0x7fdf36ad1b18 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7fdf1a45abf4 in /root/miniconda3/envs/advan/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7fdf94353ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: clone + 0x44 (0x7fdf943e4a04 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank3]:[W1001 14:15:46.446994357 ProcessGroupNCCL.cpp:1783] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
[rank2]:[W1001 14:15:46.458302501 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=44, addr=localhost:50476, remote=localhost:29500): Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7fac65ed9eb0 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694d1 (0x7fac49fef4d1 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d6a8cd (0x7fac49ff08cd in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b47a (0x7fac49ff147a in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x7fac49fec19e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x398 (0x7fac094d1b18 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7fabece5abf4 in /root/miniconda3/envs/advan/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7fac66c58ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: clone + 0x44 (0x7fac66ce9a04 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank2]:[W1001 14:15:46.461813211 ProcessGroupNCCL.cpp:1783] [PG ID 0 PG GUID 0(default_pg) Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
  2%|▏         | 206/11259 [12:26<11:40:20,  3.80s/it]  2%|▏         | 207/11259 [12:29<11:08:03,  3.63s/it][rank1]:[W1001 14:15:52.418683306 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=44, addr=localhost:50470, remote=localhost:29500): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f24e14d9eb0 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694d1 (0x7f24c55ef4d1 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d69d62 (0x7f24c55efd62 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b86e (0x7f24c55f186e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x7f24c55ec18e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x398 (0x7f2484ad1b18 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7f246845abf4 in /root/miniconda3/envs/advan/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7f24e226cac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: clone + 0x44 (0x7f24e22fda04 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank1]:[W1001 14:15:52.421767946 ProcessGroupNCCL.cpp:1783] [PG ID 0 PG GUID 0(default_pg) Rank 1] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank0]:[W1001 14:15:52.432291129 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=44, addr=localhost:50472, remote=localhost:29500): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f4af56d9eb0 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694d1 (0x7f4ad97ef4d1 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d69d62 (0x7f4ad97efd62 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b86e (0x7f4ad97f186e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x7f4ad97ec18e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x398 (0x7f4a98cd1b18 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7f4a7c65abf4 in /root/miniconda3/envs/advan/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7f4af6491ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: clone + 0x44 (0x7f4af6522a04 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank0]:[W1001 14:15:52.435029170 ProcessGroupNCCL.cpp:1783] [PG ID 0 PG GUID 0(default_pg) Rank 0] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank3]:[W1001 14:15:52.447505554 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=44, addr=localhost:50474, remote=localhost:29500): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7fdf9357eeb0 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694d1 (0x7fdf775ef4d1 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d69d62 (0x7fdf775efd62 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b86e (0x7fdf775f186e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x7fdf775ec18e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x398 (0x7fdf36ad1b18 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7fdf1a45abf4 in /root/miniconda3/envs/advan/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7fdf94353ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: clone + 0x44 (0x7fdf943e4a04 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank3]:[W1001 14:15:52.450235260 ProcessGroupNCCL.cpp:1783] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
[rank2]:[W1001 14:15:52.462361338 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=44, addr=localhost:50476, remote=localhost:29500): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7fac65ed9eb0 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694d1 (0x7fac49fef4d1 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d69d62 (0x7fac49fefd62 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b86e (0x7fac49ff186e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x30e (0x7fac49fec18e in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x398 (0x7fac094d1b18 in /root/miniconda3/envs/advan/lib/python3.12/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7fabece5abf4 in /root/miniconda3/envs/advan/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7fac66c58ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: clone + 0x44 (0x7fac66ce9a04 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank2]:[W1001 14:15:52.465263642 ProcessGroupNCCL.cpp:1783] [PG ID 0 PG GUID 0(default_pg) Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Broken pipe
  2%|▏         | 208/11259 [12:33<11:25:38,  3.72s/it]  2%|▏         | 209/11259 [12:37<11:20:40,  3.70s/it]  2%|▏         | 210/11259 [12:40<11:05:18,  3.61s/it]{'loss': 461.5738, 'grad_norm': 3029.08154296875, 'learning_rate': 1.8561278863232683e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -1.6049773693084717, 'weight_rejected': 40.137142181396484, 'epoch': 0.05596269153897402}
                                                      {'loss': 461.5738, 'grad_norm': 3029.08154296875, 'learning_rate': 1.8561278863232683e-07, 'mean_ratio_chosen': 9.974181175231934, 'mean_ratio_rejected': 9.974181175231934, 'weight_chosen': -1.6049773693084717, 'weight_rejected': 40.137142181396484, 'epoch': 0.06}
  2%|▏         | 210/11259 [12:40<11:05:18,  3.61s/it]